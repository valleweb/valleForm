"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var _slicedToArray=function(){function e(e,t){var a=[],r=!0,l=!1,n=void 0;try{for(var o,i=e[Symbol.iterator]();!(r=(o=i.next()).done)&&(a.push(o.value),!t||a.length!==t);r=!0);}catch(e){l=!0,n=e}finally{try{!r&&i.return&&i.return()}finally{if(l)throw n}}return a}return function(t,a){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,a);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_react=require("react"),_react2=_interopRequireDefault(_react),_makeJsxRows=require("./makeElements/makeJsxRows"),_makeJsxRows2=_interopRequireDefault(_makeJsxRows),_makeSpeedDialActions=require("./makeElements/makeWebcomponents/makeSpeedDialActions"),_makeSpeedDialActions2=_interopRequireDefault(_makeSpeedDialActions),_Switch=require("./components/Switch"),_Switch2=_interopRequireDefault(_Switch),_StickerLabel=require("./components/StickerLabel"),_StickerLabel2=_interopRequireDefault(_StickerLabel),_addFieldsValues=require("./fieldsControl/addFieldsValues"),_addFieldsValues2=_interopRequireDefault(_addFieldsValues),_cleanFields=require("./fieldsControl/cleanFields"),_cleanFields2=_interopRequireDefault(_cleanFields),_makeIdentifier=require("./tabErrorsControl/makeIdentifier"),_makeIdentifier2=_interopRequireDefault(_makeIdentifier),_tabErrorCountControls=require("./tabErrorsControl/tabErrorCountControls"),_tabErrorCountControls2=_interopRequireDefault(_tabErrorCountControls),_showErrorsCount=require("./tabErrorsControl/showErrorsCount"),_showErrorsCount2=_interopRequireDefault(_showErrorsCount),ValleForm=function(e){var t=e.tabs,a=void 0===t?[]:t,r=e._id,l=void 0===r?"valleForm":r,n=e.values,o=void 0===n?null:n,i=e.readOnly,u=void 0!==i&&i,s=e.baseApi,c=e.canonicalApi,_=e.params,d=e.$loading,f=void 0===d?"loading":d,m=e.buttons,p=void 0===m?[]:m,b=e.token,v=void 0===b?"":b,k=e.getData,h=e.setSnackBarStatus,C=void 0===h?null:h,E=e.ValleList,g=void 0===E?null:E,y=e.updateValleList,S=void 0===y?null:y,F=e.cleanOldFormValues,w=void 0===F?null:F,q=e.apiUpload,D=e.debug,A=e.search,R=(0,_react.useState)(!1),x=_slicedToArray(R,2),V=x[0],N=x[1],L=(0,_react.useState)(!1),T=_slicedToArray(L,2),I=T[0],J=T[1],O=(0,_react.useState)(!1),B=_slicedToArray(O,2),j=B[0],M=B[1],P=(0,_react.useState)(0),U=_slicedToArray(P,2),W=U[0],$=U[1],z=(0,_react.useState)(null),G=_slicedToArray(z,2),H=G[0],K=G[1],Q=(0,_react.useState)({}),X=_slicedToArray(Q,2),Y=X[0],Z=X[1],ee=(0,_tabErrorCountControls2.default)(Y,Z);(0,_react.useEffect)(function(){return N(u)},[u]),(0,_react.useEffect)(function(){o&&oe()},[o]);var te=function(){M(j?!1:!0)},ae=_react2.default.createRef(),re=function(){console.log("==========================="),console.log("Speed Dial:"),console.log(ae.current),console.log("==========================="),ae.current&&(ae.current.open=!1)},le=function(){N(!1),J(!0),re()},ne=function(){N(!0),J(!1),re()},oe=function(){(0,_cleanFields2.default)(l),(0,_addFieldsValues2.default)(o,l),N(!0),J(!1),re()},ie=function(){(0,_cleanFields2.default)(l,K),N(!1),J(!1),re(),w()},ue=function(){N(!1),J(!1),re(),w()},se=function(e,t){C&&C({show:!0,text:e,type:t})},ce=function(e){$(e)},_e=a.map(function(e,t){var a=W===t,r=a?"valleForm__tabs__title--selected":"",l=(0,_makeIdentifier2.default)(e.title,t),n=(0,_showErrorsCount2.default)(Y,l);return _react2.default.createElement("button",{key:t,className:"valleForm__tabs__title "+r,onClick:function(){function e(){return ce(t)}return e}()},e.title,n?_react2.default.createElement("span",{className:"valleForm__tabs__badge"}," ",n," "):null)}),de=a.map(function(e,t){var a=(0,_makeIdentifier2.default)(e.title,t),r=[];r=e.groups?e.groups.length>1?e.groups.map(function(e){var t=(0,_makeJsxRows2.default)(e.lines,j,V,I,v,l,s,_,C,g,f,ee,a,o,H,q,D);return _react2.default.createElement("div",{className:"valleForm__group",role:"group","aria-labelledby":"shipping_head"},_react2.default.createElement("h2",{className:"valleForm__group__title",id:"shipping_head"},e.title),t)}):(0,_makeJsxRows2.default)(e.groups[0].lines,j,V,I,v,l,s,_,C,g,f,ee,a,o,H,q,D):(0,_makeJsxRows2.default)(e.lines,j,V,I,v,l,s,_,C,g,f,ee,a,o,H,q,D);var n=W===t,i=n?"valleForm__tabs__tab--visible":"",u=r.filter(function(e){return null!==e});return _react2.default.createElement("div",{key:t,className:"valleForm__tabs__tab "+i},u.length?u:_react2.default.createElement("spam",{className:"valleForm__empty-message"},"Não há campos disponíveis."))});return a.length>0?_react2.default.createElement("div",{className:"valleForm",id:l},_react2.default.createElement(_StickerLabel2.default,{readOnly:V,editable:I,search:A}),D?_react2.default.createElement(_Switch2.default,{label:"Limitar campos",readOnly:V,onChange:te,_id:String(l)+"-switch"}):null,1!==a.length?_react2.default.createElement("div",{className:"valleForm__tabs__titles"},_e):null,de,_react2.default.createElement("span",{className:"valleForm__sub"},"* Campos obrigatórios"),Array.isArray(p)&&p.length?(0,_makeSpeedDialActions2.default)({buttons:p,readOnly:V,editable:I,baseApi:s,canonicalApi:c,params:_,_id:l,feedbackCb:se,editCb:le,formCb:ne,cancelCb:oe,newCB:ie,copyCB:ue,token:v,getData:k,closeSpeedDial:re,updateValleList:S,tabErrorCount:ee,setCleanup:K,speedDial:ae}):null):f};exports.default=ValleForm;